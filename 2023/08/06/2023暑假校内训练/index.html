<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="https://cdn.luogu.com.cn/upload/image_hosting/i202pvga.png?x-oss-process=image/resize,m_lfit,h_170,w_225">
  <link rel="icon" type="image/png" sizes="32x32" href="https://cdn.luogu.com.cn/upload/image_hosting/i202pvga.png?x-oss-process=image/resize,m_lfit,h_170,w_225">
  <link rel="icon" type="image/png" sizes="16x16" href="https://cdn.luogu.com.cn/upload/image_hosting/i202pvga.png?x-oss-process=image/resize,m_lfit,h_170,w_225">
  <link rel="mask-icon" href="https://cdn.luogu.com.cn/upload/image_hosting/i202pvga.png?x-oss-process=image/resize,m_lfit,h_170,w_225" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic%7CFira+Code:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://npm.elemecdn.com/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://npm.elemecdn.com/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.11.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="漫天的星光啊 那里是我的家">
<meta property="og:type" content="article">
<meta property="og:title" content="【笔记】2023暑假校内训练">
<meta property="og:url" content="http://example.com/2023/08/06/2023%E6%9A%91%E5%81%87%E6%A0%A1%E5%86%85%E8%AE%AD%E7%BB%83/index.html">
<meta property="og:site_name" content="wcy&#39;s blog">
<meta property="og:description" content="漫天的星光啊 那里是我的家">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-08-06T04:11:19.000Z">
<meta property="article:modified_time" content="2023-08-12T14:03:52.102Z">
<meta property="article:author" content="Chenyu Wu">
<meta property="article:tag" content="笔记">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2023/08/06/2023%E6%9A%91%E5%81%87%E6%A0%A1%E5%86%85%E8%AE%AD%E7%BB%83/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2023/08/06/2023%E6%9A%91%E5%81%87%E6%A0%A1%E5%86%85%E8%AE%AD%E7%BB%83/","path":"2023/08/06/2023暑假校内训练/","title":"【笔记】2023暑假校内训练"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>【笔记】2023暑假校内训练 | wcy's blog</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">wcy's blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#0371T4"><span class="nav-number">1.</span> <span class="nav-text">0371T4</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0801T2"><span class="nav-number">2.</span> <span class="nav-text">0801T2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0802T3"><span class="nav-number">3.</span> <span class="nav-text">0802T3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0804T2"><span class="nav-number">4.</span> <span class="nav-text">0804T2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0805T4"><span class="nav-number">5.</span> <span class="nav-text">0805T4</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0805T1"><span class="nav-number">6.</span> <span class="nav-text">0805T1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0805T2"><span class="nav-number">7.</span> <span class="nav-text">0805T2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0807T3"><span class="nav-number">8.</span> <span class="nav-text">0807T3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0808T0"><span class="nav-number">9.</span> <span class="nav-text">0808T0</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0808T4"><span class="nav-number">10.</span> <span class="nav-text">0808T4</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0809T3"><span class="nav-number">11.</span> <span class="nav-text">0809T3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0810T3"><span class="nav-number">12.</span> <span class="nav-text">0810T3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0810T2"><span class="nav-number">13.</span> <span class="nav-text">0810T2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CF1842G"><span class="nav-number">14.</span> <span class="nav-text">CF1842G</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CF1228E"><span class="nav-number">15.</span> <span class="nav-text">CF1228E</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0812T2"><span class="nav-number">16.</span> <span class="nav-text">0812T2</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Chenyu Wu"
      src="https://cdn.luogu.com.cn/upload/image_hosting/i202pvga.png?x-oss-process=image/resize,m_lfit,h_170,w_225">
  <p class="site-author-name" itemprop="name">Chenyu Wu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">83</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">30</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/08/06/2023%E6%9A%91%E5%81%87%E6%A0%A1%E5%86%85%E8%AE%AD%E7%BB%83/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.luogu.com.cn/upload/image_hosting/i202pvga.png?x-oss-process=image/resize,m_lfit,h_170,w_225">
      <meta itemprop="name" content="Chenyu Wu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wcy's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="【笔记】2023暑假校内训练 | wcy's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          【笔记】2023暑假校内训练
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-08-06 12:11:19" itemprop="dateCreated datePublished" datetime="2023-08-06T12:11:19+08:00">2023-08-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-08-12 22:03:52" itemprop="dateModified" datetime="2023-08-12T22:03:52+08:00">2023-08-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">笔记</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <blockquote>
<p>漫天的星光啊</p>
<p>那里是我的家</p>
</blockquote>
<span id="more"></span>
<h2 id="0371T4"><a href="#0371T4" class="headerlink" title="0371T4"></a>0371T4</h2><blockquote>
<p>给定一个长度为 $n$ 的序列，$q$ 次询问，每次询问给定 $[l, r]$，求一个最长的子区间 $[l’, r’]$，使得 $[l’, r’]$ 中出现数的种类小于 $[l, r]$ 中出现数的种类。$1 \le n, q \le 10^5$。</p>
</blockquote>
<p>场上情况：想出来了，但是来不及写了。</p>
<p>考虑一个数 $a_i$ 怎么样不会出现在一个子区间里。</p>
<ol>
<li>$a_i$ 在区间里第一次出现，此时取最长子区间 $[l, i - 1]$。</li>
<li>$a_i$ 在区间内最后一次出现，此时取最长子区间 $[i + 1, r]$。</li>
<li>$a_i$ 不是上述两种情况，此时取最长子区间 $[pre_i + 1, i - 1]$。</li>
</ol>
<p>分三类做二维偏序即可。时间复杂度 $O(n\log n)$。</p>
<p><a target="_blank" rel="noopener" href="https://loj.ac/s/1853785">Code</a></p>
<h2 id="0801T2"><a href="#0801T2" class="headerlink" title="0801T2"></a>0801T2</h2><blockquote>
<p>给定一棵 $n$ 个点的树，一些节点上有人，有 $k$ 秒活动时间，每秒一个人可以待在原地或者跳到父节点，最小化有人的节点个数。$1 \le n, k \le 10^5$</p>
</blockquote>
<p>场上情况：切了。</p>
<p>考虑贪心，假设我们现在已经处理完了 $u$ 的子树，现在要处理 $u$ 的儿子往 $u$ 上跳的情况，那么显然对于一个儿子 $v$，现在处于 $v$ 上的所有人都能跳到 $u$ 才会优。所以我们记录当前处于 $v$ 上的最大深度，看是否往上跳即可。</p>
<p><a target="_blank" rel="noopener" href="https://loj.ac/s/1853786">Code</a></p>
<h2 id="0802T3"><a href="#0802T3" class="headerlink" title="0802T3"></a>0802T3</h2><blockquote>
<p>给定一棵 $n$ 个结点的树，一个人初始在 $1$ 号结点，每秒随机走向和当前点有边的结点，求走到 $n$ 号结点的期望时间。$1 \le n \le 10^5$</p>
</blockquote>
<p>场上情况：切了。</p>
<p>好像有更强支持多测的做法，但是我场上只想到了下面的东西。</p>
<p>考虑以 $n$ 为根。设 $f_i$ 表示从 $i$ 走到 $n$ 的期望时间，显然地，我们有</p>
<script type="math/tex; mode=display">
f_u = d_u\left(\sum_{v \in \text{son}_u} f_v + f_{fa_u}\right) + 1</script><p>高斯消元可以做到 $O(n^3)$。</p>
<p>我们考虑从叶子结点往上推的过程，我们发现每个 $f<em>u$ 都可以表示为 $kf</em>{fa_u} + b$ 的形式，类似 dp 地取维护 $k, b$ 即可。时间复杂度 $O(n)$。<a target="_blank" rel="noopener" href="https://loj.ac/s/1853791">Code</a></p>
<h2 id="0804T2"><a href="#0804T2" class="headerlink" title="0804T2"></a>0804T2</h2><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/CF67C">原题</a></p>
<p>场上情况：切了。</p>
<p>只有前三种操作是编辑距离板子，考虑操作四。</p>
<p>注意题目给了一个奇怪的限制，仔细想想，这保证了每个字符最多只能被交换一次。同时一个显然的事情是，我们只会交换原有的字符，否则新加进来直接放在正确的位置上显然更优。</p>
<p>于是设 $f_{i, j}$ 表示 $A$ 的前 $i$ 位和 $B$ 前 $j$ 位匹配的最小代价。我们考虑将 $i$ 位置和 $k$ 位置进行交换，然后再在他们中间插入若干个字符，我们设最后 $A_i, \ldots, A_k$ 这一段要和 $B_l, \ldots, B_j$ 这一段匹配，所以我们需要 $A_i = B_l$，$A_k = B_j$。此时我们可以得到转移</p>
<script type="math/tex; mode=display">
f_{i, j} = \min_{A_i = B_l, A_k = B_j} f_{k - 1, l - 1} + (i - k - 1)b + (j - l - 1)a + d</script><p>这样似乎是 $O(n^4)$ 的，但是我们不难发现每次转移只会取最大的 $k$ 和 $l$，简单证明一下。</p>
<p>设 $k_1, l_1$ 是另外的一组转移，那么我们有</p>
<script type="math/tex; mode=display">
\begin{aligned}
&f_{k - 1, l - 1} + (i - k - 1)b + (j - l - 1)a + d - [f_{k_1 - 1, l_1 - 1} + (i - k_1 - 1)b + (j - l_1 - 1)a + d] \\
&= f_{k - 1, l - 1} - f_{k_1 - 1, l_1 - 1} - (k - k_1)a - (l - l_1)b
\end{aligned}</script><p>我们考虑 $f<em>{k - 1, l - 1} - f</em>{k_1 - 1, l_1 - 1}$ 的意义，就是已经拼好了前面，要拼到后面还要花费的最小的代价，不难发现 $(k - k_1)b + (l - l_1)a$ 是一种可行的代价，根据 $f$ 的最小性，我们可以判断前者小于后者，所以原式的值 $\le 0$。</p>
<p>所以我么可以预处理处每个位置的转移点，然后就可以做到 $O(n^2)$ 了。</p>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/contest/67/submission/217399413">Code</a></p>
<h2 id="0805T4"><a href="#0805T4" class="headerlink" title="0805T4"></a>0805T4</h2><blockquote>
<p>给定长度为 $n$ 字符串 $S$，记 $f<em>i = \sum</em>{j = 1}^{i - 1}[S[1:j] = S[i - j + 1: i]]\gcd(i,j)$，求 $\prod_{i = 1}^n(f_i + 1) \bmod 998244353$，$1 \le n \le 10^6$</p>
</blockquote>
<p>场上情况：首 A。</p>
<p>考虑建失配树，满足条件的 $j$ 为 $i$ 到根节点路径上的点。</p>
<p>看见 $\gcd$，想到欧拉反演，于是</p>
<script type="math/tex; mode=display">
\begin{aligned}
&f_i = \sum_{j}\gcd(i, j)\\
&=\sum_{j}\sum_{d|\gcd(i, j)}\varphi(d)\\
&=\sum_{d|i}\varphi(d)\sum_{d|j} 1
\end{aligned}</script><p>第二个和式开桶记录因数出现次数即可，时间复杂度 $O(n\log n)$。</p>
<p><a target="_blank" rel="noopener" href="https://loj.ac/s/1853822">Code</a></p>
<h2 id="0805T1"><a href="#0805T1" class="headerlink" title="0805T1"></a>0805T1</h2><blockquote>
<p>记 $f(x)$ 表示 $x$ 各位数码的 $\text{mex}$，$T$ 组询问，每次求 $\sum_{i = 1}^n f(i)$。$1 \le T \le 10^6$，$1 \le n \le 10^{18}$。</p>
</blockquote>
<p>场上情况：切了。</p>
<p>记 $f_{i, j}$ 表示还剩 $i$ 位，当前选的数状态为 $j$，不顶上界的答案，直接数位 dp 即可。</p>
<p><a target="_blank" rel="noopener" href="https://loj.ac/s/1856188">Code</a></p>
<h2 id="0805T2"><a href="#0805T2" class="headerlink" title="0805T2"></a>0805T2</h2><blockquote>
<p>给定长度为 $n$ 的序列 $A$，记 $B<em>{l, r}$ 为 $A$ 区间 $[l, r]$ 中的数排完序的序列，$m$ 次询问，求 $B</em>{l, r}$ 下标为奇数的数的和。$1 \le n, m \le 10^5$。<strong>时限 16s</strong>。</p>
</blockquote>
<p>场上情况：没取模 $100 \to 0$。</p>
<p>巨大多时限，考虑 $O(n\sqrt n\log n)$ 算法。考虑莫队，每次新加入/删除一个数相当于在值域上插入/删除一个值，权值线段树维护下标为奇数的数之和即可。时间复杂度 $O(n\sqrt n\log n)$。</p>
<p><a target="_blank" rel="noopener" href="https://loj.ac/s/1856195">Code</a></p>
<h2 id="0807T3"><a href="#0807T3" class="headerlink" title="0807T3"></a>0807T3</h2><blockquote>
<p>给定一棵 $n$ 个结点的树，第 $i$ 条边有 $p_i$ 的概率断掉，求根节点所在连通块大小的期望和方差。$1 \le n \le 1.5 \times 10^6$。</p>
</blockquote>
<p>场上情况：写了期望 $40$ 跑路。</p>
<p>设 $x_i$ 表示 $i$ 号结点是否对答案产生贡献，不难发现 $E(x_i)$ 即为 $i$ 到根节点上所有边的概率的乘积，于是期望就做完了。</p>
<p>方差的做法是根据 $D(X) = E(X^2) - E^2(X)$（场上不知道这玩意，wtcl）。其中 $E^2(X)$ 上一问求完了，于是我们考虑</p>
<script type="math/tex; mode=display">
E(X^2) = E\left(\sum_{i, j} x_ix_j\right) = \sum_{i, j}\dfrac{E(x_i)E(x_j)}{E(x_{\text{LCA(i, j)}})}</script><p>在 $\text{LCA}$ 处统计答案即可。时间复杂度 $O(n)$。</p>
<p><a target="_blank" rel="noopener" href="https://loj.ac/s/1856258">Code</a></p>
<h2 id="0808T0"><a href="#0808T0" class="headerlink" title="0808T0"></a>0808T0</h2><blockquote>
<p>有两个可重集 $S_1, S_2$，集合内的元素为二元组，$m$ 次操作，支持插入，删除，查询 </p>
<script type="math/tex; mode=display">
\min_{(A_1, B_1) \in S_1, (A_2, B_2) \in S_2} \max\{A_1 + A_2, B_1 + B_2\}</script></blockquote>
<p>场上情况：线段树分治两个栈用一个栈顶一起退栈，$100 \to 0$。</p>
<p>考虑没有删除怎么做，我们设现在新加入一个二元组 $(x, y)$，那么要求的是</p>
<script type="math/tex; mode=display">
\min_{(a, b) \in S} \max\{a + x, b + y\}</script><p>把 $\max$ 拆开，变成了两个二维偏序，线段树维护即可。</p>
<p>删除再套一个线段树分治，时间复杂度 $O(n\log^2n)$。</p>
<p><a target="_blank" rel="noopener" href="https://loj.ac/s/1856266">Code</a></p>
<h2 id="0808T4"><a href="#0808T4" class="headerlink" title="0808T4"></a>0808T4</h2><blockquote>
<p>有一条长度为 $n + 1$ 的数轴，数轴上有 $m$ 个点，坐标为 $a_1, \ldots, a_m$，每秒随机挑选一个点往前走一步，两个点重复就会合并，一个点走到 $n + 1$ 会消失，求所有点全都消失的时间的期望。$1 \le m, n \le 1000$。</p>
</blockquote>
<p>场上情况：没想到。</p>
<p>记 $a<em>{m + 1} = n + 1$，不难发现所有点全部消失的过程相当于每个点不断和下一个点合并的过程，于是记 $f</em>{i, j}$ 表示坐标为 $i$ 的点和坐标为 $j$ 的点合并 $i$ 走的步数的期望，最终答案即为 $\sum<em>{i = 1}^m f</em>{a<em>i, a</em>{i + 1}}$。$f_{i, j}$ 的转移是容易的。时间复杂度 $O(n^2)$。</p>
<p><a target="_blank" rel="noopener" href="https://loj.ac/s/1856301">Code</a></p>
<h2 id="0809T3"><a href="#0809T3" class="headerlink" title="0809T3"></a>0809T3</h2><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P6513">原题</a></p>
<p>场上情况：切了。</p>
<p>首先考虑不加边，就是换根 dp 板子。然后我们考虑加边会给答案造成多少贡献，设当前根为 $r$，我们从 $r$ 两棵不同的子树中选出两个点连边，那么我们观察到每个点的贡献可以摊到他祖先上每个点都进行计算，所以答案为 $\sum_{i 在环上, i \neq r} sz_i$。所以其实就是对于每一个点 $u$，选两条从上往下的链，使得上面那个东西最小，记最小值和次小值即可。容易换根 dp 转移，时间复杂度 $O(n)$。</p>
<p><a target="_blank" rel="noopener" href="https://loj.ac/s/1858754">Code</a></p>
<h2 id="0810T3"><a href="#0810T3" class="headerlink" title="0810T3"></a>0810T3</h2><blockquote>
<p>给定一个由字符 <code>C</code> 和 <code>T</code> 组成的字符串 $S$。$q$ 次询问，每次询问给定 $[l, r]$，求最少删除几个字符，才能使 $S[l : r]$ 中每一个前缀和每一个后缀，其 <code>C</code> 的个数不小于 <code>T</code> 的个数。$1 \le n, q \le 5 \times 10^5$。</p>
</blockquote>
<p>将 <code>C</code> 看作 $1$，<code>T</code>看作 $-1$，限制等价于任意前缀和与任意后缀和非负，记 $s_i$ 为序列的前缀和。</p>
<p>有一个显然正确的贪心，先满足前缀限制，代价为前缀最小值的绝对值，然后再在此基础上算一遍后缀。</p>
<p>考虑如何优化，记 $f(x) = -\min<em>{i \in [l, x]}{s_x - s</em>{l - 1}}$ 为将 $[l, x]$ 满足前缀限制的最小代价，那么满足前缀限制的代价就是 $f(r)$，然后在考虑计算后缀最小值，考虑在 $x$ 位置的后缀和，为 $g(x) = s<em>r - s</em>{x - 1} + f(r) - f(x - 1)$，意思是之前的值加上删去的数。然后答案即为 $f(r) - \min_{x \in [l, r]} g(x)$，将柿子展开，发现答案是</p>
<script type="math/tex; mode=display">
\max_{l - 1 \le x \le y \le r} \{s_y - s_x\} - s_r + s_{l - 1}</script><p>线段树维护最大子段和即可，时间复杂度 $O(n\log n)$。</p>
<p><a target="_blank" rel="noopener" href="https://loj.ac/s/1858786">Code</a></p>
<h2 id="0810T2"><a href="#0810T2" class="headerlink" title="0810T2"></a>0810T2</h2><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/AT_joisc2016_l">原题</a></p>
<p>感谢 LJ07 不厌其烦地教了我三遍，终于懂了。</p>
<p>场上情况：摆摆摆。</p>
<p>我们考虑对于每一个 $b_i$ 如何贪心地去匹配，首先我们肯定会贪心地选取一个 $d_j$ 最小的，满足 $a_i = c_j$，且 $j$ 还未被匹配的去和他匹配，如果不存在，我们可以随机匹配，但是随机配显然是错的，所以我们可以维护一个二分图  $G$，然后把这样的失配点丢进 $G$ 里面。所以我们每次给 $i$ 匹配的时候就相当于从 $G$ 中删去一个点 $j$。在进一步会发现，就算存在这样的 $j$，$i$ 也不一定能和他匹配，因为我们不确定删去了 $j$ 之后 $G$ 是否还存在完美匹配，根据 Hall 定理，等价于 $\min(|N(S)| - |S|) \ge 0$，更进一步，因为 $G$ 中每一个点都会向他所有前缀连边，所以我们其实不用取所有的 $S$，只需要判断前缀最小是否非负即可，每次加入/删除一个点都会影响一个前缀的 $|N(S)| - |S|$，所以我们使用线段树区间加，区间最小值即可。时间复杂度 $O(n\log n)$。</p>
<p><a target="_blank" rel="noopener" href="https://loj.ac/s/1858802">Code</a></p>
<h2 id="CF1842G"><a href="#CF1842G" class="headerlink" title="CF1842G"></a>CF1842G</h2><p>考虑用所有情况的和除以情况数来进行计算。</p>
<p>我们最后的答案肯定长这样 $\prod_i (a_i + v + \cdots +v)$，相当于我们从每个括号里面挑一个然后乘起来再求和。</p>
<p>记 $f_{i, j}$ 表示考虑到前 $i$ 个括号，已经使用了 $j$ 个操作的 $v$，所有情况的和。</p>
<p>我们考虑从当前括号选取什么来造成贡献。</p>
<ol>
<li>选择 $a<em>i$，那么 $f</em>{i, j} \gets f_{i - 1, j} \cdot a_i$。</li>
<li>选择一个在这 $j$ 次操作中带来的 $v$，那么 $f<em>{i, j} \gets f</em>{i - 1, j} \cdot v$</li>
<li>新选择一个操作的 $v$，那么我们可以从剩下的 $m - j + 1$ 个操作中选，每个操作只要作用在 $[1, i]$ 上的点就行，因此 $f<em>{i, j} \gets f</em>{i - 1, j - 1} \cdot (m - j + 1) \cdot i \cdot v$。</li>
</ol>
<p>最后考虑如何统计答案，对于 $f<em>{n, j}$ 来说，我们只关心那 $j$ 个操作使用的位置，剩下的 $m - j$ 个操作随便选都没问题，所以贡献为 $f</em>{n, j} \cdot n^{m - j}$，最后的答案即为 $\dfrac{\sum<em>{j = 0}^{\min(n, m)} f</em>{n, j} \cdot n^{m - j}}{n^m}$。时间复杂度 $O(n^2)$。</p>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1842/submission/218131102">Code</a></p>
<h2 id="CF1228E"><a href="#CF1228E" class="headerlink" title="CF1228E"></a>CF1228E</h2><p>考虑容斥。</p>
<p>记 $f(i)$ 表示钦定 $i$ 行最小值不为 $1$，且所有列最小值都为 $1$，那么答案为 $\sum_{i = 0}^n(-1)^i\binom{n}{i}f(i)$。</p>
<p>记 $g(i, j)$ 表示在钦定了 $i$ 行的基础上，钦定 $j$ 列最小值不为 $1$ 的方案数，那么 $f(i) = \sum_{j = 0}^n (-1)^j\binom{n}{j}g(i, j)$。</p>
<p>容易得到 $g(i, j) = (k - 1)^{n(i + j) - ij} \cdot k^{n^2 - n(i + j) + ij}$。</p>
<p>直接计算，时间复杂度 $O(n^2)$。</p>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1228/submission/218306128">Code</a></p>
<h2 id="0812T2"><a href="#0812T2" class="headerlink" title="0812T2"></a>0812T2</h2><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/CF1761D">原题</a></p>
<p>场上情况：切了。</p>
<p>考虑 $O(nk)$ dp，记 $f_{i, j, 0/1}$ 表示当前考虑了前 $i$ 位，进了 $j$ 次，当前是否进位的方案数，容易写出转移</p>
<script type="math/tex; mode=display">
f_{i, j, 0} \gets 3f_{i - 1, j, 0}\\
f_{i, j, 0} \gets f_{i - 1, j - 1, 1}\\
f_{i, j, 1} \gets 3f_{i - 1, j, 1}\\
f_{i, j, 1} \gets f_{i - 1, j - 1, 0}</script><p>不难发现，当 $i - 1$ 的进位状态和 $i$ 的进位状态相同时会贡献 $3$ 的系数，否则只贡献 $1$ 的系数。</p>
<p>记 $x<em>i$ 表示第 $i$ 为是否进位，特别的 $x_0 = 0$。我们可以枚举 $i$，表示有 $i$ 个 $j$ 满足 $x_j \neq x</em>{j - 1}$，那么就有 $n - i$ 个满足 $x<em>{j} = x</em>{j - 1}$ 的，所以贡献系数 $3^{n - j}$，然后观察到 $x$ 序列被分为 $i + 1$ 个连续段，那么其中就有 $\left\lceil\dfrac{i + 1}{2}\right\rceil$ 个 $0$ 的连续段，$\left\lfloor\dfrac{i + 1}{2}\right\rfloor$ 个 $1$ 的连续段，我们就相当于要把 $n - k + 1$ 个 $0$ 和 $k$ 个 $1$ 分为这么多段，所以共有 $\displaystyle\binom{n - k}{\lceil\frac{i+1}{2}\rceil - 1} \cdot \displaystyle\binom{k - 1}{\lfloor\frac{i+1}{2}\rfloor-1}$ 种选法，然后直接把所有贡献加起来即可。时间复杂度 $O(n)$。</p>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1761/submission/218437688">Code</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag"><i class="fa fa-tag"></i> 笔记</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/05/09/%E6%9D%82%E9%A2%98%E4%B9%B1%E5%81%9A/" rel="prev" title="【笔记】杂题乱做">
                  <i class="fa fa-chevron-left"></i> 【笔记】杂题乱做
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chenyu Wu</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://npm.elemecdn.com/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  





  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","mhchem":true,"js":{"url":"https://npm.elemecdn.com/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
